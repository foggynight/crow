;; sort.crw - sort a list using insertion sort

(def (insert pred elem lst)
  (if (or (null? lst)
          (pred elem (car lst)))
      (cons elem lst)
      (cons (car lst) (insert pred elem (cdr lst)))))

(def (sort pred lst)
  (if (null? lst)
      '()
      (insert pred (car lst) (sort pred (cdr lst)))))
