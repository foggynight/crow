TODO add nested definitions
TODO add symbolic macros
