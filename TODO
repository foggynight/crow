TODO add nested environments
TODO add naive macros
